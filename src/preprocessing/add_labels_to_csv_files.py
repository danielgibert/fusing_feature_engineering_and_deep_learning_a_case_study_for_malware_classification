import pandas as pd
import argparse

if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("input_filepath", help="CSV containing the features of the training samples", type=str)
    parser.add_argument("output_filepath", help="CSV containing the features of the training samples", type=str)
    parser.add_argument("labels_filepath", help="CSV containing the features of the training samples", type=str)
    args = parser.parse_args()

    #input_filepath = "../../data/feature_files/train/byte_metadata_features.csv"
    #output_filepath = "../../data/feature_files/train/byte_metadata_features_with_ids.csv"
    #labels_filepath = "../../data/feature_files/train/trainLabels.csv"

    df_features = pd.read_csv(args.input_filepath)
    df_labels = pd.read_csv(args.labels_filepath)

    df_features = df_features.sort_values('Id')
    df_labels = df_labels.sort_values('Id')

    df_features = df_features.reset_index(drop=True)
    df_labels = df_labels.reset_index(drop=True)

    df_features['Class'] = df_labels['Class']
    if "Unnamed: 0" in df_features.keys():
        df_features = df_features.drop(columns=["Unnamed: 0"])
    df_features['Class'] = df_features['Class'] - 1
    df_features.to_csv(args.output_filepath, index=False, header=True)
