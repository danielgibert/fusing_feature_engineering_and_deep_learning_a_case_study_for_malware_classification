import os
import csv
import argparse
from pe_parser.asm_parser import AssemblyParser


if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument('--train', dest='train', action='store_true')
    parser.add_argument('--no-train', dest='train', action='store_false')
    parser.set_defaults(train=True)
    args = parser.parse_args()

    if args.train is True:
        pe_filepath = "/mnt/hdd1/cerberus_mlw_data/asm/raw/train/"
        output_filepath = "../../data/feature_files/train/asm_pixel_intensity_features.csv"
    else:
        pe_filepath = "/mnt/hdd1/cerberus_mlw_data/asm/raw/test/"
        output_filepath = "../../data/feature_files/test/asm_pixel_intensity_features.csv"

    fieldnames = ['Id', 'ASM_PIXEL_0th', 'ASM_PIXEL_1th', 'ASM_PIXEL_2th', 'ASM_PIXEL_3th', 'ASM_PIXEL_4th',
                  'ASM_PIXEL_5th', 'ASM_PIXEL_6th', 'ASM_PIXEL_7th', 'ASM_PIXEL_8th', 'ASM_PIXEL_9th', 'ASM_PIXEL_10th',
                  'ASM_PIXEL_11th', 'ASM_PIXEL_12th', 'ASM_PIXEL_13th', 'ASM_PIXEL_14th', 'ASM_PIXEL_15th',
                  'ASM_PIXEL_16th', 'ASM_PIXEL_17th', 'ASM_PIXEL_18th', 'ASM_PIXEL_19th', 'ASM_PIXEL_20th',
                  'ASM_PIXEL_21th', 'ASM_PIXEL_22th', 'ASM_PIXEL_23th', 'ASM_PIXEL_24th', 'ASM_PIXEL_25th',
                  'ASM_PIXEL_26th', 'ASM_PIXEL_27th', 'ASM_PIXEL_28th', 'ASM_PIXEL_29th', 'ASM_PIXEL_30th',
                  'ASM_PIXEL_31th', 'ASM_PIXEL_32th', 'ASM_PIXEL_33th', 'ASM_PIXEL_34th', 'ASM_PIXEL_35th',
                  'ASM_PIXEL_36th', 'ASM_PIXEL_37th', 'ASM_PIXEL_38th', 'ASM_PIXEL_39th', 'ASM_PIXEL_40th',
                  'ASM_PIXEL_41th', 'ASM_PIXEL_42th', 'ASM_PIXEL_43th', 'ASM_PIXEL_44th', 'ASM_PIXEL_45th',
                  'ASM_PIXEL_46th', 'ASM_PIXEL_47th', 'ASM_PIXEL_48th', 'ASM_PIXEL_49th', 'ASM_PIXEL_50th',
                  'ASM_PIXEL_51th', 'ASM_PIXEL_52th', 'ASM_PIXEL_53th', 'ASM_PIXEL_54th', 'ASM_PIXEL_55th',
                  'ASM_PIXEL_56th', 'ASM_PIXEL_57th', 'ASM_PIXEL_58th', 'ASM_PIXEL_59th', 'ASM_PIXEL_60th',
                  'ASM_PIXEL_61th', 'ASM_PIXEL_62th', 'ASM_PIXEL_63th', 'ASM_PIXEL_64th', 'ASM_PIXEL_65th',
                  'ASM_PIXEL_66th', 'ASM_PIXEL_67th', 'ASM_PIXEL_68th', 'ASM_PIXEL_69th', 'ASM_PIXEL_70th',
                  'ASM_PIXEL_71th', 'ASM_PIXEL_72th', 'ASM_PIXEL_73th', 'ASM_PIXEL_74th', 'ASM_PIXEL_75th',
                  'ASM_PIXEL_76th', 'ASM_PIXEL_77th', 'ASM_PIXEL_78th', 'ASM_PIXEL_79th', 'ASM_PIXEL_80th',
                  'ASM_PIXEL_81th', 'ASM_PIXEL_82th', 'ASM_PIXEL_83th', 'ASM_PIXEL_84th', 'ASM_PIXEL_85th',
                  'ASM_PIXEL_86th', 'ASM_PIXEL_87th', 'ASM_PIXEL_88th', 'ASM_PIXEL_89th', 'ASM_PIXEL_90th',
                  'ASM_PIXEL_91th', 'ASM_PIXEL_92th', 'ASM_PIXEL_93th', 'ASM_PIXEL_94th', 'ASM_PIXEL_95th',
                  'ASM_PIXEL_96th', 'ASM_PIXEL_97th', 'ASM_PIXEL_98th', 'ASM_PIXEL_99th', 'ASM_PIXEL_100th',
                  'ASM_PIXEL_101th', 'ASM_PIXEL_102th', 'ASM_PIXEL_103th', 'ASM_PIXEL_104th', 'ASM_PIXEL_105th',
                  'ASM_PIXEL_106th', 'ASM_PIXEL_107th', 'ASM_PIXEL_108th', 'ASM_PIXEL_109th', 'ASM_PIXEL_110th',
                  'ASM_PIXEL_111th', 'ASM_PIXEL_112th', 'ASM_PIXEL_113th', 'ASM_PIXEL_114th', 'ASM_PIXEL_115th',
                  'ASM_PIXEL_116th', 'ASM_PIXEL_117th', 'ASM_PIXEL_118th', 'ASM_PIXEL_119th', 'ASM_PIXEL_120th',
                  'ASM_PIXEL_121th', 'ASM_PIXEL_122th', 'ASM_PIXEL_123th', 'ASM_PIXEL_124th', 'ASM_PIXEL_125th',
                  'ASM_PIXEL_126th', 'ASM_PIXEL_127th', 'ASM_PIXEL_128th', 'ASM_PIXEL_129th', 'ASM_PIXEL_130th',
                  'ASM_PIXEL_131th', 'ASM_PIXEL_132th', 'ASM_PIXEL_133th', 'ASM_PIXEL_134th', 'ASM_PIXEL_135th',
                  'ASM_PIXEL_136th', 'ASM_PIXEL_137th', 'ASM_PIXEL_138th', 'ASM_PIXEL_139th', 'ASM_PIXEL_140th',
                  'ASM_PIXEL_141th', 'ASM_PIXEL_142th', 'ASM_PIXEL_143th', 'ASM_PIXEL_144th', 'ASM_PIXEL_145th',
                  'ASM_PIXEL_146th', 'ASM_PIXEL_147th', 'ASM_PIXEL_148th', 'ASM_PIXEL_149th', 'ASM_PIXEL_150th',
                  'ASM_PIXEL_151th', 'ASM_PIXEL_152th', 'ASM_PIXEL_153th', 'ASM_PIXEL_154th', 'ASM_PIXEL_155th',
                  'ASM_PIXEL_156th', 'ASM_PIXEL_157th', 'ASM_PIXEL_158th', 'ASM_PIXEL_159th', 'ASM_PIXEL_160th',
                  'ASM_PIXEL_161th', 'ASM_PIXEL_162th', 'ASM_PIXEL_163th', 'ASM_PIXEL_164th', 'ASM_PIXEL_165th',
                  'ASM_PIXEL_166th', 'ASM_PIXEL_167th', 'ASM_PIXEL_168th', 'ASM_PIXEL_169th', 'ASM_PIXEL_170th',
                  'ASM_PIXEL_171th', 'ASM_PIXEL_172th', 'ASM_PIXEL_173th', 'ASM_PIXEL_174th', 'ASM_PIXEL_175th',
                  'ASM_PIXEL_176th', 'ASM_PIXEL_177th', 'ASM_PIXEL_178th', 'ASM_PIXEL_179th', 'ASM_PIXEL_180th',
                  'ASM_PIXEL_181th', 'ASM_PIXEL_182th', 'ASM_PIXEL_183th', 'ASM_PIXEL_184th', 'ASM_PIXEL_185th',
                  'ASM_PIXEL_186th', 'ASM_PIXEL_187th', 'ASM_PIXEL_188th', 'ASM_PIXEL_189th', 'ASM_PIXEL_190th',
                  'ASM_PIXEL_191th', 'ASM_PIXEL_192th', 'ASM_PIXEL_193th', 'ASM_PIXEL_194th', 'ASM_PIXEL_195th',
                  'ASM_PIXEL_196th', 'ASM_PIXEL_197th', 'ASM_PIXEL_198th', 'ASM_PIXEL_199th', 'ASM_PIXEL_200th',
                  'ASM_PIXEL_201th', 'ASM_PIXEL_202th', 'ASM_PIXEL_203th', 'ASM_PIXEL_204th', 'ASM_PIXEL_205th',
                  'ASM_PIXEL_206th', 'ASM_PIXEL_207th', 'ASM_PIXEL_208th', 'ASM_PIXEL_209th', 'ASM_PIXEL_210th',
                  'ASM_PIXEL_211th', 'ASM_PIXEL_212th', 'ASM_PIXEL_213th', 'ASM_PIXEL_214th', 'ASM_PIXEL_215th',
                  'ASM_PIXEL_216th', 'ASM_PIXEL_217th', 'ASM_PIXEL_218th', 'ASM_PIXEL_219th', 'ASM_PIXEL_220th',
                  'ASM_PIXEL_221th', 'ASM_PIXEL_222th', 'ASM_PIXEL_223th', 'ASM_PIXEL_224th', 'ASM_PIXEL_225th',
                  'ASM_PIXEL_226th', 'ASM_PIXEL_227th', 'ASM_PIXEL_228th', 'ASM_PIXEL_229th', 'ASM_PIXEL_230th',
                  'ASM_PIXEL_231th', 'ASM_PIXEL_232th', 'ASM_PIXEL_233th', 'ASM_PIXEL_234th', 'ASM_PIXEL_235th',
                  'ASM_PIXEL_236th', 'ASM_PIXEL_237th', 'ASM_PIXEL_238th', 'ASM_PIXEL_239th', 'ASM_PIXEL_240th',
                  'ASM_PIXEL_241th', 'ASM_PIXEL_242th', 'ASM_PIXEL_243th', 'ASM_PIXEL_244th', 'ASM_PIXEL_245th',
                  'ASM_PIXEL_246th', 'ASM_PIXEL_247th', 'ASM_PIXEL_248th', 'ASM_PIXEL_249th', 'ASM_PIXEL_250th',
                  'ASM_PIXEL_251th', 'ASM_PIXEL_252th', 'ASM_PIXEL_253th', 'ASM_PIXEL_254th', 'ASM_PIXEL_255th',
                  'ASM_PIXEL_256th', 'ASM_PIXEL_257th', 'ASM_PIXEL_258th', 'ASM_PIXEL_259th', 'ASM_PIXEL_260th',
                  'ASM_PIXEL_261th', 'ASM_PIXEL_262th', 'ASM_PIXEL_263th', 'ASM_PIXEL_264th', 'ASM_PIXEL_265th',
                  'ASM_PIXEL_266th', 'ASM_PIXEL_267th', 'ASM_PIXEL_268th', 'ASM_PIXEL_269th', 'ASM_PIXEL_270th',
                  'ASM_PIXEL_271th', 'ASM_PIXEL_272th', 'ASM_PIXEL_273th', 'ASM_PIXEL_274th', 'ASM_PIXEL_275th',
                  'ASM_PIXEL_276th', 'ASM_PIXEL_277th', 'ASM_PIXEL_278th', 'ASM_PIXEL_279th', 'ASM_PIXEL_280th',
                  'ASM_PIXEL_281th', 'ASM_PIXEL_282th', 'ASM_PIXEL_283th', 'ASM_PIXEL_284th', 'ASM_PIXEL_285th',
                  'ASM_PIXEL_286th', 'ASM_PIXEL_287th', 'ASM_PIXEL_288th', 'ASM_PIXEL_289th', 'ASM_PIXEL_290th',
                  'ASM_PIXEL_291th', 'ASM_PIXEL_292th', 'ASM_PIXEL_293th', 'ASM_PIXEL_294th', 'ASM_PIXEL_295th',
                  'ASM_PIXEL_296th', 'ASM_PIXEL_297th', 'ASM_PIXEL_298th', 'ASM_PIXEL_299th', 'ASM_PIXEL_300th',
                  'ASM_PIXEL_301th', 'ASM_PIXEL_302th', 'ASM_PIXEL_303th', 'ASM_PIXEL_304th', 'ASM_PIXEL_305th',
                  'ASM_PIXEL_306th', 'ASM_PIXEL_307th', 'ASM_PIXEL_308th', 'ASM_PIXEL_309th', 'ASM_PIXEL_310th',
                  'ASM_PIXEL_311th', 'ASM_PIXEL_312th', 'ASM_PIXEL_313th', 'ASM_PIXEL_314th', 'ASM_PIXEL_315th',
                  'ASM_PIXEL_316th', 'ASM_PIXEL_317th', 'ASM_PIXEL_318th', 'ASM_PIXEL_319th', 'ASM_PIXEL_320th',
                  'ASM_PIXEL_321th', 'ASM_PIXEL_322th', 'ASM_PIXEL_323th', 'ASM_PIXEL_324th', 'ASM_PIXEL_325th',
                  'ASM_PIXEL_326th', 'ASM_PIXEL_327th', 'ASM_PIXEL_328th', 'ASM_PIXEL_329th', 'ASM_PIXEL_330th',
                  'ASM_PIXEL_331th', 'ASM_PIXEL_332th', 'ASM_PIXEL_333th', 'ASM_PIXEL_334th', 'ASM_PIXEL_335th',
                  'ASM_PIXEL_336th', 'ASM_PIXEL_337th', 'ASM_PIXEL_338th', 'ASM_PIXEL_339th', 'ASM_PIXEL_340th',
                  'ASM_PIXEL_341th', 'ASM_PIXEL_342th', 'ASM_PIXEL_343th', 'ASM_PIXEL_344th', 'ASM_PIXEL_345th',
                  'ASM_PIXEL_346th', 'ASM_PIXEL_347th', 'ASM_PIXEL_348th', 'ASM_PIXEL_349th', 'ASM_PIXEL_350th',
                  'ASM_PIXEL_351th', 'ASM_PIXEL_352th', 'ASM_PIXEL_353th', 'ASM_PIXEL_354th', 'ASM_PIXEL_355th',
                  'ASM_PIXEL_356th', 'ASM_PIXEL_357th', 'ASM_PIXEL_358th', 'ASM_PIXEL_359th', 'ASM_PIXEL_360th',
                  'ASM_PIXEL_361th', 'ASM_PIXEL_362th', 'ASM_PIXEL_363th', 'ASM_PIXEL_364th', 'ASM_PIXEL_365th',
                  'ASM_PIXEL_366th', 'ASM_PIXEL_367th', 'ASM_PIXEL_368th', 'ASM_PIXEL_369th', 'ASM_PIXEL_370th',
                  'ASM_PIXEL_371th', 'ASM_PIXEL_372th', 'ASM_PIXEL_373th', 'ASM_PIXEL_374th', 'ASM_PIXEL_375th',
                  'ASM_PIXEL_376th', 'ASM_PIXEL_377th', 'ASM_PIXEL_378th', 'ASM_PIXEL_379th', 'ASM_PIXEL_380th',
                  'ASM_PIXEL_381th', 'ASM_PIXEL_382th', 'ASM_PIXEL_383th', 'ASM_PIXEL_384th', 'ASM_PIXEL_385th',
                  'ASM_PIXEL_386th', 'ASM_PIXEL_387th', 'ASM_PIXEL_388th', 'ASM_PIXEL_389th', 'ASM_PIXEL_390th',
                  'ASM_PIXEL_391th', 'ASM_PIXEL_392th', 'ASM_PIXEL_393th', 'ASM_PIXEL_394th', 'ASM_PIXEL_395th',
                  'ASM_PIXEL_396th', 'ASM_PIXEL_397th', 'ASM_PIXEL_398th', 'ASM_PIXEL_399th', 'ASM_PIXEL_400th',
                  'ASM_PIXEL_401th', 'ASM_PIXEL_402th', 'ASM_PIXEL_403th', 'ASM_PIXEL_404th', 'ASM_PIXEL_405th',
                  'ASM_PIXEL_406th', 'ASM_PIXEL_407th', 'ASM_PIXEL_408th', 'ASM_PIXEL_409th', 'ASM_PIXEL_410th',
                  'ASM_PIXEL_411th', 'ASM_PIXEL_412th', 'ASM_PIXEL_413th', 'ASM_PIXEL_414th', 'ASM_PIXEL_415th',
                  'ASM_PIXEL_416th', 'ASM_PIXEL_417th', 'ASM_PIXEL_418th', 'ASM_PIXEL_419th', 'ASM_PIXEL_420th',
                  'ASM_PIXEL_421th', 'ASM_PIXEL_422th', 'ASM_PIXEL_423th', 'ASM_PIXEL_424th', 'ASM_PIXEL_425th',
                  'ASM_PIXEL_426th', 'ASM_PIXEL_427th', 'ASM_PIXEL_428th', 'ASM_PIXEL_429th', 'ASM_PIXEL_430th',
                  'ASM_PIXEL_431th', 'ASM_PIXEL_432th', 'ASM_PIXEL_433th', 'ASM_PIXEL_434th', 'ASM_PIXEL_435th',
                  'ASM_PIXEL_436th', 'ASM_PIXEL_437th', 'ASM_PIXEL_438th', 'ASM_PIXEL_439th', 'ASM_PIXEL_440th',
                  'ASM_PIXEL_441th', 'ASM_PIXEL_442th', 'ASM_PIXEL_443th', 'ASM_PIXEL_444th', 'ASM_PIXEL_445th',
                  'ASM_PIXEL_446th', 'ASM_PIXEL_447th', 'ASM_PIXEL_448th', 'ASM_PIXEL_449th', 'ASM_PIXEL_450th',
                  'ASM_PIXEL_451th', 'ASM_PIXEL_452th', 'ASM_PIXEL_453th', 'ASM_PIXEL_454th', 'ASM_PIXEL_455th',
                  'ASM_PIXEL_456th', 'ASM_PIXEL_457th', 'ASM_PIXEL_458th', 'ASM_PIXEL_459th', 'ASM_PIXEL_460th',
                  'ASM_PIXEL_461th', 'ASM_PIXEL_462th', 'ASM_PIXEL_463th', 'ASM_PIXEL_464th', 'ASM_PIXEL_465th',
                  'ASM_PIXEL_466th', 'ASM_PIXEL_467th', 'ASM_PIXEL_468th', 'ASM_PIXEL_469th', 'ASM_PIXEL_470th',
                  'ASM_PIXEL_471th', 'ASM_PIXEL_472th', 'ASM_PIXEL_473th', 'ASM_PIXEL_474th', 'ASM_PIXEL_475th',
                  'ASM_PIXEL_476th', 'ASM_PIXEL_477th', 'ASM_PIXEL_478th', 'ASM_PIXEL_479th', 'ASM_PIXEL_480th',
                  'ASM_PIXEL_481th', 'ASM_PIXEL_482th', 'ASM_PIXEL_483th', 'ASM_PIXEL_484th', 'ASM_PIXEL_485th',
                  'ASM_PIXEL_486th', 'ASM_PIXEL_487th', 'ASM_PIXEL_488th', 'ASM_PIXEL_489th', 'ASM_PIXEL_490th',
                  'ASM_PIXEL_491th', 'ASM_PIXEL_492th', 'ASM_PIXEL_493th', 'ASM_PIXEL_494th', 'ASM_PIXEL_495th',
                  'ASM_PIXEL_496th', 'ASM_PIXEL_497th', 'ASM_PIXEL_498th', 'ASM_PIXEL_499th', 'ASM_PIXEL_500th',
                  'ASM_PIXEL_501th', 'ASM_PIXEL_502th', 'ASM_PIXEL_503th', 'ASM_PIXEL_504th', 'ASM_PIXEL_505th',
                  'ASM_PIXEL_506th', 'ASM_PIXEL_507th', 'ASM_PIXEL_508th', 'ASM_PIXEL_509th', 'ASM_PIXEL_510th',
                  'ASM_PIXEL_511th', 'ASM_PIXEL_512th', 'ASM_PIXEL_513th', 'ASM_PIXEL_514th', 'ASM_PIXEL_515th',
                  'ASM_PIXEL_516th', 'ASM_PIXEL_517th', 'ASM_PIXEL_518th', 'ASM_PIXEL_519th', 'ASM_PIXEL_520th',
                  'ASM_PIXEL_521th', 'ASM_PIXEL_522th', 'ASM_PIXEL_523th', 'ASM_PIXEL_524th', 'ASM_PIXEL_525th',
                  'ASM_PIXEL_526th', 'ASM_PIXEL_527th', 'ASM_PIXEL_528th', 'ASM_PIXEL_529th', 'ASM_PIXEL_530th',
                  'ASM_PIXEL_531th', 'ASM_PIXEL_532th', 'ASM_PIXEL_533th', 'ASM_PIXEL_534th', 'ASM_PIXEL_535th',
                  'ASM_PIXEL_536th', 'ASM_PIXEL_537th', 'ASM_PIXEL_538th', 'ASM_PIXEL_539th', 'ASM_PIXEL_540th',
                  'ASM_PIXEL_541th', 'ASM_PIXEL_542th', 'ASM_PIXEL_543th', 'ASM_PIXEL_544th', 'ASM_PIXEL_545th',
                  'ASM_PIXEL_546th', 'ASM_PIXEL_547th', 'ASM_PIXEL_548th', 'ASM_PIXEL_549th', 'ASM_PIXEL_550th',
                  'ASM_PIXEL_551th', 'ASM_PIXEL_552th', 'ASM_PIXEL_553th', 'ASM_PIXEL_554th', 'ASM_PIXEL_555th',
                  'ASM_PIXEL_556th', 'ASM_PIXEL_557th', 'ASM_PIXEL_558th', 'ASM_PIXEL_559th', 'ASM_PIXEL_560th',
                  'ASM_PIXEL_561th', 'ASM_PIXEL_562th', 'ASM_PIXEL_563th', 'ASM_PIXEL_564th', 'ASM_PIXEL_565th',
                  'ASM_PIXEL_566th', 'ASM_PIXEL_567th', 'ASM_PIXEL_568th', 'ASM_PIXEL_569th', 'ASM_PIXEL_570th',
                  'ASM_PIXEL_571th', 'ASM_PIXEL_572th', 'ASM_PIXEL_573th', 'ASM_PIXEL_574th', 'ASM_PIXEL_575th',
                  'ASM_PIXEL_576th', 'ASM_PIXEL_577th', 'ASM_PIXEL_578th', 'ASM_PIXEL_579th', 'ASM_PIXEL_580th',
                  'ASM_PIXEL_581th', 'ASM_PIXEL_582th', 'ASM_PIXEL_583th', 'ASM_PIXEL_584th', 'ASM_PIXEL_585th',
                  'ASM_PIXEL_586th', 'ASM_PIXEL_587th', 'ASM_PIXEL_588th', 'ASM_PIXEL_589th', 'ASM_PIXEL_590th',
                  'ASM_PIXEL_591th', 'ASM_PIXEL_592th', 'ASM_PIXEL_593th', 'ASM_PIXEL_594th', 'ASM_PIXEL_595th',
                  'ASM_PIXEL_596th', 'ASM_PIXEL_597th', 'ASM_PIXEL_598th', 'ASM_PIXEL_599th', 'ASM_PIXEL_600th',
                  'ASM_PIXEL_601th', 'ASM_PIXEL_602th', 'ASM_PIXEL_603th', 'ASM_PIXEL_604th', 'ASM_PIXEL_605th',
                  'ASM_PIXEL_606th', 'ASM_PIXEL_607th', 'ASM_PIXEL_608th', 'ASM_PIXEL_609th', 'ASM_PIXEL_610th',
                  'ASM_PIXEL_611th', 'ASM_PIXEL_612th', 'ASM_PIXEL_613th', 'ASM_PIXEL_614th', 'ASM_PIXEL_615th',
                  'ASM_PIXEL_616th', 'ASM_PIXEL_617th', 'ASM_PIXEL_618th', 'ASM_PIXEL_619th', 'ASM_PIXEL_620th',
                  'ASM_PIXEL_621th', 'ASM_PIXEL_622th', 'ASM_PIXEL_623th', 'ASM_PIXEL_624th', 'ASM_PIXEL_625th',
                  'ASM_PIXEL_626th', 'ASM_PIXEL_627th', 'ASM_PIXEL_628th', 'ASM_PIXEL_629th', 'ASM_PIXEL_630th',
                  'ASM_PIXEL_631th', 'ASM_PIXEL_632th', 'ASM_PIXEL_633th', 'ASM_PIXEL_634th', 'ASM_PIXEL_635th',
                  'ASM_PIXEL_636th', 'ASM_PIXEL_637th', 'ASM_PIXEL_638th', 'ASM_PIXEL_639th', 'ASM_PIXEL_640th',
                  'ASM_PIXEL_641th', 'ASM_PIXEL_642th', 'ASM_PIXEL_643th', 'ASM_PIXEL_644th', 'ASM_PIXEL_645th',
                  'ASM_PIXEL_646th', 'ASM_PIXEL_647th', 'ASM_PIXEL_648th', 'ASM_PIXEL_649th', 'ASM_PIXEL_650th',
                  'ASM_PIXEL_651th', 'ASM_PIXEL_652th', 'ASM_PIXEL_653th', 'ASM_PIXEL_654th', 'ASM_PIXEL_655th',
                  'ASM_PIXEL_656th', 'ASM_PIXEL_657th', 'ASM_PIXEL_658th', 'ASM_PIXEL_659th', 'ASM_PIXEL_660th',
                  'ASM_PIXEL_661th', 'ASM_PIXEL_662th', 'ASM_PIXEL_663th', 'ASM_PIXEL_664th', 'ASM_PIXEL_665th',
                  'ASM_PIXEL_666th', 'ASM_PIXEL_667th', 'ASM_PIXEL_668th', 'ASM_PIXEL_669th', 'ASM_PIXEL_670th',
                  'ASM_PIXEL_671th', 'ASM_PIXEL_672th', 'ASM_PIXEL_673th', 'ASM_PIXEL_674th', 'ASM_PIXEL_675th',
                  'ASM_PIXEL_676th', 'ASM_PIXEL_677th', 'ASM_PIXEL_678th', 'ASM_PIXEL_679th', 'ASM_PIXEL_680th',
                  'ASM_PIXEL_681th', 'ASM_PIXEL_682th', 'ASM_PIXEL_683th', 'ASM_PIXEL_684th', 'ASM_PIXEL_685th',
                  'ASM_PIXEL_686th', 'ASM_PIXEL_687th', 'ASM_PIXEL_688th', 'ASM_PIXEL_689th', 'ASM_PIXEL_690th',
                  'ASM_PIXEL_691th', 'ASM_PIXEL_692th', 'ASM_PIXEL_693th', 'ASM_PIXEL_694th', 'ASM_PIXEL_695th',
                  'ASM_PIXEL_696th', 'ASM_PIXEL_697th', 'ASM_PIXEL_698th', 'ASM_PIXEL_699th', 'ASM_PIXEL_700th',
                  'ASM_PIXEL_701th', 'ASM_PIXEL_702th', 'ASM_PIXEL_703th', 'ASM_PIXEL_704th', 'ASM_PIXEL_705th',
                  'ASM_PIXEL_706th', 'ASM_PIXEL_707th', 'ASM_PIXEL_708th', 'ASM_PIXEL_709th', 'ASM_PIXEL_710th',
                  'ASM_PIXEL_711th', 'ASM_PIXEL_712th', 'ASM_PIXEL_713th', 'ASM_PIXEL_714th', 'ASM_PIXEL_715th',
                  'ASM_PIXEL_716th', 'ASM_PIXEL_717th', 'ASM_PIXEL_718th', 'ASM_PIXEL_719th', 'ASM_PIXEL_720th',
                  'ASM_PIXEL_721th', 'ASM_PIXEL_722th', 'ASM_PIXEL_723th', 'ASM_PIXEL_724th', 'ASM_PIXEL_725th',
                  'ASM_PIXEL_726th', 'ASM_PIXEL_727th', 'ASM_PIXEL_728th', 'ASM_PIXEL_729th', 'ASM_PIXEL_730th',
                  'ASM_PIXEL_731th', 'ASM_PIXEL_732th', 'ASM_PIXEL_733th', 'ASM_PIXEL_734th', 'ASM_PIXEL_735th',
                  'ASM_PIXEL_736th', 'ASM_PIXEL_737th', 'ASM_PIXEL_738th', 'ASM_PIXEL_739th', 'ASM_PIXEL_740th',
                  'ASM_PIXEL_741th', 'ASM_PIXEL_742th', 'ASM_PIXEL_743th', 'ASM_PIXEL_744th', 'ASM_PIXEL_745th',
                  'ASM_PIXEL_746th', 'ASM_PIXEL_747th', 'ASM_PIXEL_748th', 'ASM_PIXEL_749th', 'ASM_PIXEL_750th',
                  'ASM_PIXEL_751th', 'ASM_PIXEL_752th', 'ASM_PIXEL_753th', 'ASM_PIXEL_754th', 'ASM_PIXEL_755th',
                  'ASM_PIXEL_756th', 'ASM_PIXEL_757th', 'ASM_PIXEL_758th', 'ASM_PIXEL_759th', 'ASM_PIXEL_760th',
                  'ASM_PIXEL_761th', 'ASM_PIXEL_762th', 'ASM_PIXEL_763th', 'ASM_PIXEL_764th', 'ASM_PIXEL_765th',
                  'ASM_PIXEL_766th', 'ASM_PIXEL_767th', 'ASM_PIXEL_768th', 'ASM_PIXEL_769th', 'ASM_PIXEL_770th',
                  'ASM_PIXEL_771th', 'ASM_PIXEL_772th', 'ASM_PIXEL_773th', 'ASM_PIXEL_774th', 'ASM_PIXEL_775th',
                  'ASM_PIXEL_776th', 'ASM_PIXEL_777th', 'ASM_PIXEL_778th', 'ASM_PIXEL_779th', 'ASM_PIXEL_780th',
                  'ASM_PIXEL_781th', 'ASM_PIXEL_782th', 'ASM_PIXEL_783th', 'ASM_PIXEL_784th', 'ASM_PIXEL_785th',
                  'ASM_PIXEL_786th', 'ASM_PIXEL_787th', 'ASM_PIXEL_788th', 'ASM_PIXEL_789th', 'ASM_PIXEL_790th',
                  'ASM_PIXEL_791th', 'ASM_PIXEL_792th', 'ASM_PIXEL_793th', 'ASM_PIXEL_794th', 'ASM_PIXEL_795th',
                  'ASM_PIXEL_796th', 'ASM_PIXEL_797th', 'ASM_PIXEL_798th', 'ASM_PIXEL_799th']

    with open(output_filepath, "w") as output_file:
        writer = csv.DictWriter(output_file, fieldnames=fieldnames)
        writer.writeheader()
        i = 0
        filenames = os.listdir(pe_filepath)
        for filename in filenames:
            asm_parser = AssemblyParser()
            print("{};{}".format(i,pe_filepath+filename))
            asm_parser.load_asm_file(pe_filepath+filename)
            asm_img = asm_parser.convert_asm_to_img()
            pixel_intensity_features = asm_parser.extract_pixel_intensities(800)
            pixel_intensity_features['Id'] = filename[:-4]
            writer.writerow({feature_name: pixel_intensity_features[feature_name] for feature_name in fieldnames})
            i+=1