import os
import pandas as pd


filepath = "../../data/feature_files/train/subsets_with_labels/"

filenames = os.listdir(filepath)

df = pd.read_csv(filepath + filenames[0])
df = df.sort_values(by=['Id'], ascending=False, ignore_index=True)
for filename in filenames[1:]:
    df2 = pd.read_csv(filepath + filename)
    df2 = df2.sort_values(by=['Id'], ascending=False, ignore_index=True)

    df_merge = pd.merge(df, df2, on='Id')
    print(filenames[0], filename)
    print(df['Id'].equals(df2['Id']), df_merge['Id'].equals(df['Id']), df_merge['Id'].equals(df2['Id']))


df = pd.read_csv(filepath+"asm_section_features.csv")
df = df.sort_values(by=['Id'], ascending=False, ignore_index=True)

df2 = pd.read_csv(filepath+"asm_cnn_opcode_features.csv")
df2 = df2.sort_values(by=['Id'], ascending=False, ignore_index=True)

print(df.head(), df2.head())
print(df['Class'].dtype, df2['Class'].dtype)
df_merge = pd.merge(df, df2, on='Id')
print(df['Id'].equals(df2['Id']), df_merge['Id'].equals(df['Id']), df_merge['Id'].equals(df2['Id']))
print(df['Class'].equals(df2['Class']))
print(df_merge['Class_x'].equals(df_merge['Class_y']))

for col in list(df_merge.columns):
    if col.endswith("_x") or col.endswith("_y"):
        print(col)
