import pandas as pd
import argparse

if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("csv_filepath", help="CSV containing the predictions", type=str)
    args = parser.parse_args()

    df = pd.read_csv(args.csv_filepath)

    df['Prediction1'] = df['Prediction1'].apply(lambda row: 0.0 if row <= 0.5 else 1.0)
    df['Prediction2'] = df['Prediction2'].apply(lambda row: 0.0 if row <= 0.5 else 1.0)
    df['Prediction3'] = df['Prediction3'].apply(lambda row: 0.0 if row <= 0.5 else 1.0)
    df['Prediction4'] = df['Prediction4'].apply(lambda row: 0.0 if row <= 0.5 else 1.0)
    df['Prediction5'] = df['Prediction5'].apply(lambda row: 0.0 if row <= 0.5 else 1.0)
    df['Prediction6'] = df['Prediction6'].apply(lambda row: 0.0 if row <= 0.5 else 1.0)
    df['Prediction7'] = df['Prediction7'].apply(lambda row: 0.0 if row <= 0.5 else 1.0)
    df['Prediction8'] = df['Prediction8'].apply(lambda row: 0.0 if row <= 0.5 else 1.0)
    df['Prediction9'] = df['Prediction9'].apply(lambda row: 0.0 if row <= 0.5 else 1.0)

    df.to_csv(args.csv_filepath+"_onehotvector", index=False)

